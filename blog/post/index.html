<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Seattle Real Estate Blog | Zor Keeler</title>
  <meta name="description" content="Seattle real estate insights, market context, and neighborhood notes from broker Zor Keeler." />
  <link rel="canonical" href="https://zorkeeler.com/blog/" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/theme.css" />
  <script defer src="/assets/js/site.js"></script>
</head>
<body>
  <header class="header" role="banner">
    <div class="inner">
      <a class="brand" href="/"><span class="brand-name">Zor Keeler</span><span class="brand-divider" aria-hidden="true"></span><img class="brand-mark mark-blue" src="/assets/img/TEC_blue_crop.png" alt="TEC Real Estate, Inc."><img class="brand-mark mark-white" src="/assets/img/TEC_white_crop.png" alt=""></a>
      <button class="menu-toggle" aria-label="Toggle navigation" aria-expanded="false" aria-controls="site-menu">
        <span class="line"></span><span class="line"></span><span class="line"></span>
      </button>
      <nav id="site-menu" class="nav" aria-label="Primary">
        <a href="/buy/">Buy</a>
        <a href="/sell/">Sell</a>
        <a href="/neighborhoods/">Neighborhoods</a>
        <a href="/blog/">Blog</a>
        <a href="/about/">About</a>
        <a class="cta" href="tel:2069473858">Call Zor</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="section">
      <div class="wrap article-simple">
        <header class="article-header">
          <a class="article-back" href="/blog/">← Back to blog</a>
          <h1 id="article-title">Loading article…</h1>
          <p class="lead" id="article-excerpt"></p>
          <div class="article-meta" id="article-meta"></div>
          <div class="article-tags" id="article-tags" hidden></div>
        </header>
        <figure class="article-image" id="article-footnote"></figure>
        <article class="blog-article-body" id="article-body"></article>
        <div class="article-related" id="article-related"></div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="wrap footer-inner">
      <div class="footer-brand">
        <h3 class="footer-heading">Zor Keeler</h3>
        <p class="footer-role">Broker, TEC Real Estate, Inc.</p>
        <div class="footer-contact">
          <a href="tel:2069473858">206-947-3858</a>
          <a href="mailto:zor@zorkeeler.com">zor@zorkeeler.com</a>
        </div>
      </div>
      <div class="footer-column">
        <h4>Explore</h4>
        <ul class="footer-links inline">
          <li><a href="/">Home</a></li>
          <li><a href="/buy/">Buy</a></li>
          <li><a href="/sell/">Sell</a></li>
          <li><a href="/neighborhoods/">Neighborhoods</a></li>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/about/">About</a></li>
        </ul>
      </div>
      <div class="footer-column">
        <h4>Resources</h4>
        <ul class="footer-links compact">
          <li><a href="/about/#contact">Contact</a></li>
          <li><a href="/dmca/">DMCA Notice</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-copy">© <span id="y"></span> Zor Keeler · TEC Real Estate, Inc. · Seattle, WA</div>
  </footer>
</body>
<script>
(function(){
  const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQxqpI4zoU8QrK_TtB82_CRNn0Io7aSvvNvpAHn5UZFMpJqBXG-OdhP-PiEgE2ZBh6JpagmIwA_Uj44/pub?gid=0&single=true&output=csv";
  const PLACEHOLDER = "/assets/img/Seattle%20Homes.jpg";

  const $ = (sel) => document.querySelector(sel);
  const articleTitle = $("#article-title");
  const articleExcerpt = $("#article-excerpt");
  const articleMeta = $("#article-meta");
  const articleTags = $("#article-tags");
  const articleBody = $("#article-body");
  const articleFootnote = $("#article-footnote");
  const articleRelated = $("#article-related");

  const params = new URLSearchParams(window.location.search);
  const slugParam = params.get("slug");

  function parseCSV(text){
    const rows=[]; let i=0, cur="", row=[], inQ=false;
    while(i<text.length){
      const ch=text[i], next=text[i+1];
      if(ch==='\"'){
        if(inQ && next==='\"'){ cur+='\"'; i++; }
        else inQ=!inQ;
      } else if(ch===',' && !inQ){
        row.push(cur); cur="";
      } else if((ch==='\n' || ch==='\r') && !inQ){
        if(cur!=="" || row.length){ row.push(cur); rows.push(row); row=[]; cur=""; }
      } else {
        cur+=ch;
      }
      i++;
    }
    if(cur!=="" || row.length){ row.push(cur); rows.push(row); }
    return rows;
  }

  const norm = str => (str||"").trim().toLowerCase().replace(/[^a-z0-9_]+/g,"_");
  const slugify = (value="") => value.toString().toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"") || `post-${Date.now()}`;
  const stripHTML = html => { const tmp=document.createElement("div"); tmp.innerHTML=html; return tmp.textContent||tmp.innerText||""; };

  const toParagraphs = content => {
    if(!content) return "";
    if (/<\s*\w+[^>]*>/i.test(content)) return content;
    return content.trim()
      .split(/\n\s*\n+/)
      .map(p => `<p>${p.replace(/\n/g, "<br>")}</p>`)
      .join("");
  };

  const canonicalImageURL = src => {
    if(!src) return "";
    let url = src.trim();
    if(!/^https?:\/\//i.test(url)) return "";
    if(/drive\.google\.com/i.test(url)){
      const idMatch = url.match(/\/d\/([a-zA-Z0-9_-]+)/) || url.match(/[?&]id=([a-zA-Z0-9_-]+)/);
      const id = idMatch ? idMatch[1] : "";
      if(id){
        if(/\/thumbnail/i.test(url)){
          const szMatch = url.match(/[?&]sz=([^&]+)/);
          const size = szMatch ? szMatch[1] : "w2000";
          return `https://drive.google.com/thumbnail?id=${id}&sz=${size}`;
        }
        return `https://drive.google.com/uc?id=${id}&export=view`;
      }
    }
    return url;
  };



  const computeReadingTime = content => {
    const text = stripHTML(content);
    if(!text) return "";
    const words = text.split(/\s+/).filter(Boolean).length;
    const minutes = Math.max(1, Math.round(words / 225));
    return `${minutes} min read`;
  };

  function renderPost(post, relatedPosts){
    const title = post.title || "Article";
    document.title = `${title} | Zor Keeler`;
    articleTitle.textContent = title;
    articleExcerpt.textContent = post.excerpt || "";
    const metaPieces = [];
    if(post.date) metaPieces.push(new Date(post.date).toLocaleDateString(undefined,{year:"numeric", month:"short", day:"numeric"}));
    const rt = post.readingTime || computeReadingTime(post.contentHTML || post.contentMd || post.content_md || "");
    if(rt) metaPieces.push(rt);
    articleMeta.innerHTML = metaPieces.map(piece => `<span>${piece}</span>`).join("");
    if(post.tags && post.tags.length){
      articleTags.hidden = false;
      articleTags.innerHTML = post.tags.map(tag => `<span class="blog-tag">${tag}</span>`).join("");
    } else {
      articleTags.hidden = true;
    }
    const content = post.contentHTML || post.contentMd || post.content_md || "";
    articleBody.innerHTML = toParagraphs(content);
    const imageUrl = canonicalImageURL(post.image) || PLACEHOLDER;
    articleFootnote.innerHTML = imageUrl ? `<img src="${imageUrl}" alt="${title} hero image" loading="lazy">` : "";

    if(articleRelated){
      if(relatedPosts && relatedPosts.length){
        articleRelated.innerHTML = `
          <h3>More articles</h3>
          <ul>
            ${relatedPosts.map(p => `<li><a href="/blog/post/?slug=${encodeURIComponent(p.slug)}">${p.title}</a></li>`).join("")}
          </ul>
        `;
      } else {
        articleRelated.innerHTML = "";
      }
    }
  }

  function handleError(){
    articleTitle.textContent = "Article not found";
    articleExcerpt.textContent = "We couldn't load that article. Return to the blog for the latest notes.";
    articleBody.innerHTML = "";
    articleTags.hidden = true;
  }

  fetch(CSV_URL)
    .then(res => res.text())
    .then(csvText => {
      const rows = parseCSV(csvText);
      const headers = rows.shift() || [];
      const index = {};
      headers.forEach((h,i) => index[norm(h)]=i);
      const val = (row, key) => row[index[key]] ?? "";
      const posts = rows.map(row => {
        if((val(row,"published") || "").toLowerCase() !== "true") return null;
        const title = val(row,"title") || "";
        const slug = val(row,"slug") || slugify(title);
        return {
          slug,
          title,
          date: val(row,"date"),
          tags: (val(row,"tags") || "").split(/[,|]/).map(t=>t.trim()).filter(Boolean),
          excerpt: val(row,"excerpt"),
          contentHTML: val(row,"content_html"),
          contentMd: val(row,"content_md"),
          readingTime: val(row,"reading_time"),
          image: val(row,"image_url"),
          canonicalUrl: val(row,"canonical_url")
        };
      }).filter(Boolean);

      const targetIndex = posts.findIndex(p => !slugParam || p.slug === slugParam);
      const post = posts[targetIndex >= 0 ? targetIndex : 0];
      if(!post){
        handleError();
        return;
      }
      const relatedPosts = posts.filter((_, idx) => idx !== targetIndex).slice(0,4);
      renderPost(post, relatedPosts);
    })
    .catch(() => handleError());
})();
</script>
</html>
